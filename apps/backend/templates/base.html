{% load static i18n %}

<!DOCTYPE html>
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}" class="h-full">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>
      {% block title %}
        {{ system_name|default:"PUCSR SIS" }}
      {% endblock title %}
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
          content="Pannasastra University of Cambodia Student Information System" />
    <link rel="icon" href="{% static 'favicon.ico' %}" />
    {% block css %}
      <!-- Preconnect to external domains -->
      <link rel="preconnect" href="https://fonts.googleapis.com" />
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
      <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
      <!-- Critical CSS - Tailwind -->
      <script src="https://cdn.tailwindcss.com"></script>
      <!-- Fonts -->
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
            rel="stylesheet" />
      <!-- Icons -->
      <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
            integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer" />
      <!-- Application CSS -->
      <link href="{% static 'css/layout.css' %}" rel="stylesheet" />
      <style>
        body {
          font-family: 'Inter', sans-serif;
        }
      </style>
      {% block extra_css %}
      {% endblock extra_css %}
    {% endblock css %}
  </head>
  <body class="antialiased bg-slate-50 dark:bg-slate-900">
    <div class="relative min-h-screen lg:flex">
      {% if request.user.is_authenticated %}
        <!-- Sidebar -->
        {% include 'components/sidebar.html' %}
        <!-- Mobile Overlay -->
        <div id="mobile-overlay"
             class="fixed inset-0 bg-black/50 z-20 hidden lg:hidden"
             aria-hidden="true"></div>
        <!-- Main Content Area -->
        <div id="main-content" class="flex-1 flex flex-col">
          <!-- Header -->
          {% include 'components/header.html' %}
          <!-- Main Page Content -->
          <main class="flex-grow" role="main">
            {% include 'components/messages.html' %}
            {% block content %}
            {% endblock content %}
          </main>
        </div>
      {% else %}
        <!-- Login Container -->
        <div class="w-full">
          {% block login_content %}
          {% endblock login_content %}
        </div>
      {% endif %}
    </div>
    {% block javascript %}
      <!-- HTMX -->
      <script src="https://unpkg.com/htmx.org@1.9.10"
              integrity="sha384-D1Kt99CQMDuVetoL1lrYwg5t+9QdHe7NLX/SoJYkXDFfX37iInKRy5xLSi8nO7UC"
              crossorigin="anonymous"></script>
      <!-- Application JavaScript -->
      <script src="{% static 'js/layout.js' %}" defer></script>
      {% block extra_js %}
      {% endblock extra_js %}
    {% endblock javascript %}
  </body>
</html>
