{# Reusable Modal Component with HTMX Support #} {# Usage: {% include
'components/modal.html' with modal_id="my-modal" title="Modal Title" %} #} {#
Sizes: sm, md (default), lg, xl #}
{% load i18n %}

<div id="{{ modal_id|default:'modal' }}"
     class="fixed inset-0 z-50 hidden overflow-y-auto"
     aria-labelledby="{{ modal_id|default:'modal' }}-title"
     role="dialog"
     aria-modal="true">
  <!-- Backdrop -->
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
       onclick="closeModal('{{ modal_id|default:'modal' }}')"
       aria-hidden="true"></div>
  <!-- Modal Panel -->
  <div class="flex min-h-full items-center justify-center p-4">
    <div class="relative transform overflow-hidden rounded-lg bg-white shadow-xl transition-all w-full {% if size == 'sm' %}max-w-md{% elif size == 'lg' %}max-w-4xl{% elif size == 'xl' %}max-w-6xl{% else %}max-w-2xl{% endif %}"
         onclick="event.stopPropagation()">
      <!-- Header -->
      {% if title or not hide_header %}
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 border-b">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-medium leading-6 text-gray-900"
                id="{{ modal_id|default:'modal' }}-title">{{ title|default:"" }}</h3>
            {% if not hide_close %}
              <button type="button"
                      onclick="closeModal('{{ modal_id|default:'modal' }}')"
                      class="rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                <span class="sr-only">{% trans "Close" %}</span>
                <svg class="h-6 w-6"
                     fill="none"
                     viewBox="0 0 24 24"
                     stroke-width="1.5"
                     stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            {% endif %}
          </div>
        </div>
      {% endif %}
      <!-- Content -->
      <div class="bg-white px-4 pt-5 pb-4 sm:p-6"
           id="{{ modal_id|default:'modal' }}-content">
        {% block modal_content %}{{ content|safe }}{% endblock %}
      </div>
      <!-- Footer -->
      {% if footer or not hide_footer %}
        <div class="bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6 border-t">
          {% block modal_footer %}{{ footer|safe }}{% endblock %}
          {% if not
            footer and not hide_footer %}
            <button type="button"
                    onclick="closeModal('{{ modal_id|default:'modal' }}')"
                    class="mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
              {% trans "Close" %}
            </button>
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>
</div>
<script>
  function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.remove('hidden');
      document.body.classList.add('overflow-hidden');
    }
  }

  function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    }
  }

  // Close modal on Escape key
  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
      const modals = document.querySelectorAll(
        '.fixed.inset-0.z-50:not(.hidden)'
      );
      modals.forEach((modal) => {
        modal.classList.add('hidden');
      });
      document.body.classList.remove('overflow-hidden');
    }
  });
</script>
