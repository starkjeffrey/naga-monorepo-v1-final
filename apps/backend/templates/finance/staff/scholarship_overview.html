{% extends "base_new.html" %}

{% load static i18n humanize %}

{% block title %}Scholarship Overview - {{ block.super }}{% endblock %}
{% block extra_css %}
  <style>
    .stat-card {
      @apply bg-white rounded-lg shadow-md p-6 border-l-4;
    }

    .stat-card.primary {
      @apply border-blue-500;
    }

    .stat-card.success {
      @apply border-green-500;
    }

    .stat-card.warning {
      @apply border-yellow-500;
    }

    .stat-card.info {
      @apply border-purple-500;
    }
  </style>
{% endblock %}
{% block content %}
  <div class="container mx-auto px-4 py-6">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-800 mb-2">Scholarship Overview</h1>
      <p class="text-gray-600">
        Manage scholarships and sponsor payments for {{ current_term.name|default:"Current Term" }}
      </p>
    </div>
    <!-- Summary Statistics -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
      <div class="stat-card primary">
        <h3 class="text-lg font-semibold text-gray-700 mb-2">Active Awards</h3>
        <p class="text-3xl font-bold text-blue-600">{{ stats.total_awards|intcomma }}</p>
      </div>
      <div class="stat-card success">
        <h3 class="text-lg font-semibold text-gray-700 mb-2">Total Amount</h3>
        <p class="text-3xl font-bold text-green-600">${{ stats.total_amount|floatformat:2|intcomma }}</p>
      </div>
      <div class="stat-card warning">
        <h3 class="text-lg font-semibold text-gray-700 mb-2">Students Sponsored</h3>
        <p class="text-3xl font-bold text-yellow-600">{{ stats.students_count|intcomma }}</p>
      </div>
      <div class="stat-card info">
        <h3 class="text-lg font-semibold text-gray-700 mb-2">Active Sponsors</h3>
        <p class="text-3xl font-bold text-purple-600">{{ stats.sponsors_count|intcomma }}</p>
      </div>
    </div>
    <!-- Note about Scholarship Module -->
    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-8">
      <div class="flex">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 text-yellow-400"
               viewBox="0 0 20 20"
               fill="currentColor">
            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
          </svg>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-medium text-yellow-800">Scholarship Module Coming Soon</h3>
          <div class="mt-2 text-sm text-yellow-700">
            <p>
              The scholarship management module is currently under development.
              This overview shows placeholder data.
            </p>
          </div>
        </div>
      </div>
    </div>
    <!-- Active Awards -->
    <div class="mb-8">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Active Scholarship Awards</h2>
      <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Student</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Scholarship</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sponsor</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            {% for award in active_awards %}
              <tr>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="text-sm font-medium text-gray-900">{{ award.student_name }}</div>
                  <div class="text-sm text-gray-500">ID: {{ award.student_id }}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ award.scholarship_name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ award.sponsor_name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                  ${{ award.amount|floatformat:2|intcomma }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Active</span>
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="5" class="px-6 py-4 text-center text-gray-500">No active scholarship awards found</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <!-- Recent Sponsor Payments -->
    <div class="mb-8">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Recent Sponsor Payments</h2>
      <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sponsor</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Students Covered</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Reference</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            {% for payment in recent_payments %}
              <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ payment.date|date:"M d, Y" }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ payment.sponsor_name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                  ${{ payment.amount|floatformat:2|intcomma }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ payment.student_count }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ payment.reference }}</td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="5" class="px-6 py-4 text-center text-gray-500">No recent sponsor payments found</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <!-- Sponsor Balances -->
    <div>
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Sponsor Account Balances</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for sponsor in sponsor_balances %}
          <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-2">{{ sponsor.name }}</h3>
            <div class="space-y-2">
              <p class="text-sm text-gray-600">
                <span class="font-medium">Balance:</span>
                <span class="text-lg font-bold {% if sponsor.balance < 0 %}text-red-600{% else %}text-green-600{% endif %}">
                  ${{ sponsor.balance|floatformat:2|intcomma }}
                </span>
              </p>
              <p class="text-sm text-gray-600">
                <span class="font-medium">Students:</span> {{ sponsor.student_count }}
              </p>
            </div>
          </div>
        {% empty %}
          <div class="col-span-full text-center text-gray-500 py-8">No sponsor data available</div>
        {% endfor %}
      </div>
    </div>
  </div>
{% endblock %}
{% block extra_js %}
  <script>
    // Add any JavaScript for enhanced functionality
    document.addEventListener('DOMContentLoaded', function() {
      // Future functionality:
      // - Real-time sponsor balance updates
      // - Scholarship allocation interface
      // - Payment tracking dashboard
    });
  </script>
{% endblock %}
