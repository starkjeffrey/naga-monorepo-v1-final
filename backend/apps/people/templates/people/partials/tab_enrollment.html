<!-- Enrollment Tab Content -->
<div class="space-y-6">
  <!-- Current Enrollment Card -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">
        <i class="fas fa-book-open mr-2 text-gray-400"></i>
        Current Enrollment - {{ current_term.name|default:"Spring 2024" }}
      </h2>
      <span class="text-sm text-gray-500 dark:text-gray-400">
        {{ current_enrollments|length }} courses | {{ total_current_credits }} credits
      </span>
    </div>
    <div class="space-y-4">
      {% for enrollment in current_enrollments %}
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow">
          <div class="flex justify-between items-start">
            <div class="flex-grow">
              <div class="flex items-center space-x-3">
                <h3 class="font-medium text-gray-900 dark:text-gray-100">
                  {{ enrollment.class_section.course.course_code }} - {{ enrollment.class_section.course.title }}
                </h3>
                {% if enrollment.is_audit %}
                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300">
                    Audit
                  </span>
                {% endif %}
              </div>
              <div class="mt-2 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600 dark:text-gray-400">
                <div>
                  <i class="fas fa-user-tie mr-1"></i>
                  Instructor: {{ enrollment.class_section.primary_instructor.person.full_name|default:"TBA" }}
                </div>
                <div>
                  <i class="fas fa-clock mr-1"></i>
                  {{ enrollment.class_section.meeting_pattern|default:"Schedule TBA" }}
                </div>
                <div>
                  <i class="fas fa-map-marker-alt mr-1"></i>
                  {{ enrollment.class_section.room.full_name|default:"Room TBA" }}
                </div>
                <div>
                  <i class="fas fa-users mr-1"></i>
                  {{ enrollment.class_section.current_enrollment }}/{{ enrollment.class_section.capacity }} students
                </div>
              </div>
              {% if enrollment.class_section.notes %}
                <p class="mt-2 text-sm text-gray-500 dark:text-gray-400 italic">{{ enrollment.class_section.notes }}</p>
              {% endif %}
            </div>
            <div class="ml-4 text-right">
              <span class="text-lg font-semibold text-gray-900 dark:text-gray-100">
                {{ enrollment.class_section.credits }} credits
              </span>
              <div class="mt-2">
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium {% if enrollment.enrollment_status == 'ENROLLED' %}bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400 {% elif enrollment.enrollment_status == 'WAITLISTED' %}bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400 {% else %}bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400{% endif %}">
                  {{ enrollment.get_enrollment_status_display }}
                </span>
              </div>
              {% if enrollment.current_grade %}
                <p class="mt-2 text-sm font-medium text-gray-700 dark:text-gray-300">Current: {{ enrollment.current_grade }}</p>
              {% endif %}
            </div>
          </div>
          <!-- Action Buttons -->
          <div class="mt-4 flex space-x-2">
            <button class="text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">
              <i class="fas fa-calendar-alt mr-1"></i> View Schedule
            </button>
            <button class="text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">
              <i class="fas fa-book mr-1"></i> Course Materials
            </button>
            {% if enrollment.enrollment_status == 'WAITLISTED' %}
              <span class="text-sm text-gray-500 dark:text-gray-400">
                <i class="fas fa-list-ol mr-1"></i> Position: #{{ enrollment.waitlist_position }}
              </span>
            {% endif %}
          </div>
        </div>
      {% empty %}
        <div class="text-center py-8">
          <i class="fas fa-book-open text-4xl text-gray-300 dark:text-gray-600 mb-3"></i>
          <p class="text-gray-500 dark:text-gray-400">No current enrollments</p>
        </div>
      {% endfor %}
    </div>
  </div>
  <!-- Registration Holds -->
  {% if registration_holds %}
    <div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4">
      <div class="flex items-start">
        <i class="fas fa-exclamation-circle text-red-600 dark:text-red-400 mt-0.5 mr-3"></i>
        <div class="flex-grow">
          <h3 class="font-medium text-red-900 dark:text-red-200 mb-2">Registration Holds</h3>
          <ul class="space-y-1 text-sm text-red-700 dark:text-red-300">
            {% for hold in registration_holds %}
              <li>â€¢ {{ hold.hold_type }}: {{ hold.description }} (Contact: {{ hold.contact_office }})</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  {% endif %}
  <!-- Enrollment History -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
    <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">
      <i class="fas fa-history mr-2 text-gray-400"></i>
      Enrollment History
    </h2>
    <!-- Term Filter -->
    <div class="mb-4">
      <select class="form-select rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200">
        <option>All Terms</option>
        {% for term in available_terms %}<option value="{{ term.id }}">{{ term.name }}</option>{% endfor %}
      </select>
    </div>
    <!-- Enrollment Timeline -->
    <div class="space-y-6">
      {% for term_enrollment in enrollment_history %}
        <div class="border-l-4 border-blue-500 pl-4">
          <h3 class="font-medium text-gray-900 dark:text-gray-100 mb-2">
            {{ term_enrollment.term.name }}
            <span class="text-sm text-gray-500 dark:text-gray-400 ml-2">({{ term_enrollment.total_credits }} credits)</span>
          </h3>
          <div class="grid gap-2">
            {% for enrollment in term_enrollment.enrollments %}
              <div class="flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700 last:border-0">
                <div>
                  <span class="font-medium text-sm text-gray-900 dark:text-gray-100">
                    {{ enrollment.class_section.course.course_code }}
                  </span>
                  <span class="text-sm text-gray-600 dark:text-gray-400 ml-2">{{ enrollment.class_section.course.title }}</span>
                </div>
                <div class="flex items-center space-x-4">
                  <span class="text-sm text-gray-500 dark:text-gray-400">{{ enrollment.class_section.credits }} credits</span>
                  {% if enrollment.final_grade %}
                    <span class="font-medium text-sm text-gray-900 dark:text-gray-100">{{ enrollment.final_grade }}</span>
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          </div>
          <div class="mt-2 text-sm text-gray-500 dark:text-gray-400">
            Term GPA: {{ term_enrollment.term_gpa|floatformat:2 }}
          </div>
        </div>
      {% empty %}
        <p class="text-sm text-gray-500 dark:text-gray-400 text-center py-4">No enrollment history available.</p>
      {% endfor %}
    </div>
  </div>
  <!-- Add/Drop History -->
  {% if add_drop_history %}
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
      <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">
        <i class="fas fa-exchange-alt mr-2 text-gray-400"></i>
        Add/Drop History
      </h2>
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
          <thead>
            <tr>
              <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                Date
              </th>
              <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                Action
              </th>
              <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                Course
              </th>
              <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                Reason
              </th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
            {% for action in add_drop_history %}
              <tr>
                <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-100">{{ action.action_date|date:"M d, Y" }}</td>
                <td class="px-4 py-3 text-sm">
                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium {% if action.action_type == 'ADD' %}bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400 {% else %}bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400{% endif %}">
                    {{ action.get_action_type_display }}
                  </span>
                </td>
                <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-100">
                  {{ action.course_code }} - {{ action.course_title }}
                </td>
                <td class="px-4 py-3 text-sm text-gray-500 dark:text-gray-400">{{ action.reason|default:"-" }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  {% endif %}
</div>
