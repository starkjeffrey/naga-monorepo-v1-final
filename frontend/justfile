default:
  just --list

# Backend Django commands
up:
  cd backend && docker compose -f docker-compose.local.yml up -d

check:
  cd backend && docker compose -f docker-compose.local.yml run --rm django python manage.py check

upbuild:
  cd backend && docker compose -f docker-compose.local.yml up --build -d

down:
  cd backend && docker compose -f docker-compose.local.yml down

clearmigrations:
  cd backend && find . -path "*/migrations/*.py" \
    -not -path "*/accounts/*" \
    -not -name "__init__.py" \
    -not -name "naga/contrib/sites/migrations/*.py" \
    -delete

migrate:
  cd backend && docker compose -f docker-compose.local.yml run --rm django python manage.py migrate

makemigrations:
  cd backend && docker compose -f docker-compose.local.yml run --rm django python manage.py makemigrations

uvupgrade:
  cd backend && uv lock --upgrade

superuser:
  cd backend && docker compose -f docker-compose.local.yml run --rm django python manage.py createsuperuser

# Additional backend commands
shell:
  cd backend && docker compose -f docker-compose.local.yml run --rm django python manage.py shell

test:
  cd backend && docker compose -f docker-compose.local.yml run --rm django pytest

ruff-check:
  cd backend && docker compose -f docker-compose.local.yml run --rm django ruff check

ruff-format:
  cd backend && docker compose -f docker-compose.local.yml run --rm django ruff format

mypy:
  cd backend && docker compose -f docker-compose.local.yml run --rm django mypy naga

logs:
  cd backend && docker compose -f docker-compose.local.yml logs -f

# Frontend commands
frontend-install:
  cd frontend && npm install

frontend-dev:
  cd frontend && npm run dev

frontend-build:
  cd frontend && npm run build

frontend-mobile-dev:
  cd frontend && npm run mobile:dev

# Combined commands
dev: up frontend-dev

lint: ruff-check mypy

format: ruff-format
